{"version":3,"sources":["actions.js","TileView.js","EdgeView.js","VertexView.js","GameBoard.js","GameContainer.js","GameMenu.js","RulesPage.js","LevelSelect.js","App.js","serviceWorker.js","game.js","store.js","index.js"],"names":["receiveProgress","progress","type","newGame","text","visitVertex","id","resetLevel","TileView","_this$props","this","props","tile","tileState","tileSize","edgeSize","classes","tileType","valid","symbol","push","react_default","a","createElement","className","join","style","width","height","left","x1","top","y1","color","Component","EdgeView","edge","edgeState","x2","visited","broken","VertexView","vertex","vertexState","vertexType","x","y","GameBoard","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","onMouseDown","bind","assertThisInitialized","onMouseMove","onMouseUp","state","dragging","div","addEventListener","passive","e","position","target","level","targetTouches","preventDefault","nativeEvent","clientX","offsetLeft","clientY","offsetTop","col","Math","round","row","console","log","rows","cols","_this$props2","_this2","_this$props3","boardSize","vMargin","hMargin","tiles","overlay","completed","won","ref","marginTop","marginBottom","marginLeft","marginRight","map","t","i","src_TileView","key","edges","src_EdgeView","edgeId","vertices","v","src_VertexView","vertexId","connect","dispatch","Actions","GameContainer","updateSize","r","getBoundingClientRect","min","setState","window","removeEventListener","_this$state","prevLevel","nextLevel","onClick","src_GameBoard","assign","levelId","setTimeout","GameMenu","showLevelSelect","showRules","currentDifficulty","TileDescription","tileSpec","updateTileDescription","value","description","onChange","placeholder","RulesPage","hideRules","visible","maxWidth","margin","tileTypes","RulesPage_TileDescription","rulesShown","setCurrentDifficulty","difficulty","selected","UnlockRow","winsToNextUnlock","maxDifficulty","LevelSelect","hideLevelSelect","LevelSelect_TileDescription","LevelSelect_UnlockRow","levelSelectShown","val","App","loadProgress","src_GameContainer","src_GameMenu","src_RulesPage","src_LevelSelect","progressString","localStorage","getItem","JSON","parse","Boolean","location","hostname","match","blank","validate","paired","generateSubtype","groupSize","floor","random","place","regions","availableColors","sort","b","colorCount","length","_loop","availableRegions","toConsumableArray","keys","filter","regionId","region","some","regionCount","j","ri","splice","k","availableTiles","tileId","otherTile","sameColor","unclaimedRegions","maxInRegion","ceil","countInRegion","conflicts","allSymbols","neighbouringVertices","getVisitedEdges","path","visitedEdges","pi1","indexOf","pi2","abs","expandRegion","startTile","unmatchedTiles","neighbours","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","err","return","calculateRegions","generateLevel","name","topEdge","y2","leftEdge","entries","exits","solution","randomPath","nextPoints","foundSolution","shouldBacktrack","nextVertexId","concat","solutionRegion","breaks","initialProgress","initialState","objectSpread","persistProgress","setItem","stringify","store","createStore","arguments","action","lastVertexId","backtrackVertexId","findIndex","pop","tv","newState","usedSymbols","availableSymbols","s","availableTypes","generateTileType","applyMiddleware","thunk","ReactDOM","render","es","src_App_0","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.97fa79c5.chunk.js","sourcesContent":["\nexport const requestProgress = text => ({\n    type: 'REQUEST_PROGRESS',\n    text\n});\n\nexport const receiveProgress = progress => ({\n    type: 'RECEIVE_PROGRESS',\n    progress\n});\n\nexport function loadProgress() {\n    return function(dispatch) {\n        let progressString = localStorage.getItem('progress');\n        let progress = progressString ? JSON.parse(progressString) : null;\n\n        dispatch(receiveProgress(progress));\n    };\n}\n\n\nexport const newGame = text => ({\n    type: 'NEW_GAME',\n    text\n});\n\nexport const visitVertex = id => ({\n    type: 'VISIT_VERTEX',\n    id\n});\n\nexport const resetLevel = id => ({\n    type: 'RESET_LEVEL',\n    id\n});\n\nexport const showLevelSelect = id => ({\n    type: 'SHOW_LEVEL_SELECT',\n    id\n});\n\nexport const hideLevelSelect = id => ({\n    type: 'HIDE_LEVEL_SELECT',\n    id\n});\n\nexport const showRules = id => ({\n    type: 'SHOW_RULES',\n    id\n});\n\n\nexport const hideRules = id => ({\n    type: 'HIDE_RULES',\n    id\n});\n\nexport const setCurrentDifficulty = val => ({\n    type: 'SET_CURRENT_DIFFICULTY',\n    val\n});\n\nexport const updateTileDescription = (id, description) => ({\n    type: 'UPDATE_TILE_DESCRIPTION',\n    id,\n    description\n});","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nclass TileView extends Component {\n    render() {\n        let {tile, tileState, tileSize, edgeSize} = this.props;\n        let classes = [\"tile\", tile.tileType, tileState.valid ? \" valid\" : \" invalid\"];\n        if (tile.symbol) {\n            classes.push(\"symbol\");\n            classes.push(\"symbol-\" + tile.symbol);\n        }\n        return (\n            <div className={classes.join(\" \")} style={{\n                width: tileSize,\n                height: tileSize,\n                left: (tile.x1 * (tileSize + edgeSize)),\n                top: (tile.y1 * (tileSize + edgeSize)),\n                color: tile.color || \"black\"\n            }}>\n            </div>\n        );\n    }\n}\n\nTileView.propTypes = {\n    tile: PropTypes.shape({\n        tileType: PropTypes.string.isRequired,\n        x1: PropTypes.number.isRequired,\n        y1: PropTypes.number.isRequired,\n    }).isRequired,\n    tileState: PropTypes.shape({\n        valid: PropTypes.bool.isRequired,\n    }).isRequired,\n    tileSize: PropTypes.number.isRequired,\n    edgeSize: PropTypes.number.isRequired,\n};\n\n\nexport default TileView;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nclass EdgeView extends Component {\n    render() {\n        let {edge, edgeState, tileSize, edgeSize} = this.props;\n        if (edge.x1 === edge.x2) {\n            // vertical\n            return (\n                <div className={\"edge vertical\" + (edgeState.visited ? \" visited\" : \"\") + (edge.broken ? \" broken\" : \"\")} style={{\n                    width: edgeSize,\n                    height: tileSize,\n                    left: (edge.x1 * (tileSize + edgeSize) - edgeSize),\n                    top: (edge.y1 * (tileSize + edgeSize))\n                }}>\n                </div>\n            );\n        }\n        else {\n            return (\n                <div className={\"edge horizontal\" + (edgeState.visited ? \" visited\" : \"\") + (edge.broken ? \" broken\" : \"\")} style={{\n                    width: tileSize,\n                    height: edgeSize,\n                    left: (edge.x1 * (tileSize + edgeSize)),\n                    top: (edge.y1 * (tileSize + edgeSize) - edgeSize)\n                }}>\n                </div>\n            );\n        }\n    }\n}\n\nEdgeView.propTypes = {\n    edge: PropTypes.shape({\n        x1: PropTypes.number.isRequired,\n        y1: PropTypes.number.isRequired,\n        broken: PropTypes.bool.isRequired,\n    }).isRequired,\n    tileSize: PropTypes.number.isRequired,\n    edgeSize: PropTypes.number.isRequired,\n    edgeState: PropTypes.shape({\n        visited: PropTypes.bool.isRequired\n    }).isRequired\n};\n\nexport default EdgeView;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nclass VertexView extends Component {\n    render() {\n        let {vertex, vertexState, tileSize, edgeSize} = this.props;\n        if (vertex.vertexType === \"entry\") {\n            return (\n                <div className={'vertex ' + (vertex.vertexType || \"\") + (vertexState.visited ? \" visited\" : \"\")} style={{\n                    width: edgeSize * 3,\n                    height: edgeSize * 3,\n                    left: (vertex.x * (tileSize + edgeSize) - edgeSize - edgeSize),\n                    top: (vertex.y * (tileSize + edgeSize) - edgeSize - edgeSize)\n                }}>\n                </div>\n            );\n        }\n        else if (vertex.vertexType === \"exit\") {\n            return (\n                <div className={'vertex ' + (vertex.vertexType || \"\") + (vertexState.visited ? \" visited\" : \"\")} style={{\n                    width: edgeSize * 3,\n                    height: edgeSize * 3,\n                    left: (vertex.x * (tileSize + edgeSize) - edgeSize - edgeSize),\n                    top: (vertex.y * (tileSize + edgeSize) - edgeSize - edgeSize)\n                }}>\n                </div>\n            );\n        }\n        else {\n            return (\n                <div className={'vertex ' + (vertex.vertexType || \"\") + (vertexState.visited ? \" visited\" : \"\")} style={{\n                    width: edgeSize,\n                    height: edgeSize,\n                    left: (vertex.x * (tileSize + edgeSize) - edgeSize),\n                    top: (vertex.y * (tileSize + edgeSize) - edgeSize)\n                }}>\n\n                </div>\n            );\n        }\n\n    }\n}\n\nVertexView.propTypes = {\n    vertex: PropTypes.shape({\n        vertexType: PropTypes.string.isRequired,\n        x: PropTypes.number.isRequired,\n        y: PropTypes.number.isRequired,\n    }).isRequired,\n    tileSize: PropTypes.number.isRequired,\n    edgeSize: PropTypes.number.isRequired,\n    vertexState: PropTypes.shape({\n        visited: PropTypes.bool.isRequired\n    }).isRequired\n};\n\nexport default VertexView;","import { connect } from 'react-redux';\nimport * as Actions from './actions';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport TileView from './TileView';\nimport EdgeView from './EdgeView';\nimport VertexView from './VertexView';\n\nclass GameBoard extends Component {\n    constructor() {\n        super();\n        this.onMouseDown = this.onMouseDown.bind(this);\n        this.onMouseMove = this.onMouseMove.bind(this);\n        this.onMouseUp = this.onMouseUp.bind(this);\n        this.state = {};\n        this.dragging = false;\n    }\n    componentDidMount() {\n        this.div.addEventListener(\"touchstart\", this.onMouseDown);\n        this.div.addEventListener(\"touchmove\", this.onMouseMove, {passive: false});\n        this.div.addEventListener(\"touchend\", this.onMouseUp);\n    }\n    onMouseDown(e) {\n        this.dragging = true;\n    }\n    onMouseMove(e) {\n        if (!this.dragging) return;\n        let {level, visitVertex, tileSize, edgeSize} = this.props;\n        let position, target;\n        if (e.targetTouches) {\n            position = e.targetTouches[0];\n            target = e.target;\n            e.preventDefault();\n        }\n        else {\n            position = e.nativeEvent;\n            target = e.nativeEvent.target;\n        }\n        if (!position || !target) return;\n\n        let x = (position.clientX - target.offsetLeft);\n        let y = (position.clientY - target.offsetTop);\n\n        // find nearest vertex\n\n        let col = Math.round(x / (tileSize + edgeSize)) - 1;\n        let row = Math.round(y / (tileSize + edgeSize)) - 1;\n        console.log(x + \", \" + y + \" => \" + col + \", \" + row);\n\n        if (col >= 0 && row >= 0 && row <= level.rows && col <= level.cols) {\n            let vertexId = row * (level.cols + 1) + col;\n            visitVertex(vertexId);\n        }\n    }\n    onMouseUp(e) {\n        if (!this.dragging) return;\n        this.dragging = false;\n        let {level, visitVertex, tileSize, edgeSize} = this.props;\n\n        let position, target;\n        if (e.targetTouches) {\n            position = e.targetTouches[0];\n            target = e.target;\n        }\n        else {\n            position = e.nativeEvent;\n            target = e.nativeEvent.target;\n        }\n        if (!position || !target) return;\n\n        let x = (position.clientX - target.offsetLeft);\n        let y = (position.clientY - target.offsetTop);\n\n        // find nearest vertex\n\n        let col = Math.round(x / (tileSize + edgeSize)) - 1;\n        let row = Math.round(y / (tileSize + edgeSize)) - 1;\n        console.log(x + \", \" + y + \" => \" + col + \", \" + row);\n\n        if (col >= 0 && row >= 0 && row <= level.rows && col <= level.cols) {\n            let vertexId = row * (level.cols + 1) + col;\n            visitVertex(vertexId);\n        }\n    }\n    render() {\n        let {level, tileSize, edgeSize, boardSize, vMargin, hMargin} = this.props;\n        if (!level || !level.tiles || !level.tiles[0]) {\n            return (\n                <div className=\"board\">\n          No game loaded;\n                </div>\n            );\n        }\n        else {\n            let overlay = null;\n            if (level.completed && !level.won) {\n                overlay = (\n                    <div className=\"boardOverlay\">\n\n                    </div>\n                );\n            }\n            else if (level.completed && level.won) {\n                overlay = (\n                    <div className=\"boardOverlay\">\n\n                    </div>\n                );\n            }\n            return (\n                <div\n                    className={\"board \" + (level.completed ? \" completed\" : \"\") + (level.won ? \" won\" : \"\") }\n                    ref={e => (this.div = e)}\n                    onMouseDown={this.onMouseDown}\n                    onMouseMove={this.onMouseMove}\n                    onMouseUp={this.onMouseUp}\n                    style={{\n                        marginTop: vMargin,\n                        marginBottom: vMargin,\n                        marginLeft: hMargin,\n                        marginRight: hMargin,\n                        width: boardSize,\n                        height: boardSize\n                    }}\n                >\n                    {level.tiles.map((t, i) => (<TileView\n                        key={i}\n                        tile={t}\n                        tileState={level.tileState[i]}\n                        tileSize={tileSize}\n                        edgeSize={edgeSize} />))}\n                    {level.edges.map((e, i) => (<EdgeView\n                        key={i}\n                        edge={e}\n                        edgeId={i}\n                        edgeState={level.edgeState[i]}\n                        tileSize={tileSize}\n                        edgeSize={edgeSize} />))}\n                    {level.vertices.map((v, i) => (<VertexView\n                        key={i}\n                        vertex={v}\n                        vertexId={i}\n                        vertexState={level.vertexState[i]}\n                        tileSize={tileSize}\n                        edgeSize={edgeSize} />))}\n                    {overlay}\n                </div>\n            );\n        }\n    }\n}\n\nGameBoard.propTypes = {\n    level: PropTypes.shape({\n\n    }).isRequired,\n    resetLevel: PropTypes.func.isRequired,\n    newGame: PropTypes.func.isRequired,\n    visitVertex: PropTypes.func.isRequired,\n    tileSize: PropTypes.number.isRequired,\n    edgeSize: PropTypes.number.isRequired,\n    boardSize: PropTypes.number.isRequired\n};\n\nexport default connect(\n    state => ({\n        // level: state.level,\n    }),\n    dispatch => ({\n        resetLevel: id => dispatch(Actions.resetLevel(id)),\n        newGame: id => dispatch(Actions.newGame(id)),\n        visitVertex: id => dispatch(Actions.visitVertex(id))\n    })\n)(GameBoard);","import { connect } from 'react-redux';\nimport * as Actions from './actions';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport GameBoard from './GameBoard';\n\nclass GameContainer extends Component {\n    constructor() {\n        super();\n        this.state = {\n            tileSize: 50,\n            edgeSize: 10\n        };\n        this.updateSize = this.updateSize.bind(this);\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (!state.level || !props.level) {\n            return {\n                nextLevel: null,\n                level: props.level,\n                prevLevel: null\n            };\n        }\n\n        if (state.level && props.level && state.level.levelId !== props.level.levelId) {\n            // resetting to new level\n            console.log(\"resetting\");\n            return {\n                nextLevel: props.level,\n                level: null,\n                prevLevel: state.level\n            };\n        }\n\n        if (!state.level.completed && props.level.completed) {\n            if (props.level.won) {\n                setTimeout(() => props.newGame(), 500);\n            }\n            else {\n                setTimeout(() => props.resetLevel(), 1000);\n            }\n        }\n\n        return {\n            nextLevel: null,\n            level: props.level,\n            prevLevel: null\n        };\n    }\n    updateSize() {\n        if (!this.div) return;\n        let r = this.div.getBoundingClientRect();\n        console.log(r);\n        let boardSize = Math.min(r.width, r.height) - 20;\n        let edgeSize = boardSize / 60;\n        let tileSize = (boardSize / (this.props.level.cols + 2)) - edgeSize;\n        this.setState({\n            boardSize: boardSize,\n            vMargin: (r.height - boardSize) / 2,\n            hMargin: (r.width - boardSize) / 2,\n            tileSize: tileSize,\n            edgeSize: edgeSize\n        });\n    }\n    componentDidMount() {\n        this.updateSize();\n        window.addEventListener(\"resize\", this.updateSize);\n    }\n    componentWillUnmount() {\n        window.removeEventListener(\"resize\", this.updateSize);\n    }\n    render() {\n        let {level, prevLevel, nextLevel, tileSize, edgeSize, boardSize, vMargin, hMargin} = this.state;\n        return (\n            <div className=\"boardcontainer\" ref={e => (this.div = e)} onClick={this.onClick}>\n                {(prevLevel ? (<div className=\"prevLevel\"><GameBoard level={prevLevel} {...{tileSize, edgeSize, boardSize, vMargin, hMargin}} /></div>) : null)}\n                {(level ? (<div className=\"currentLevel\"><GameBoard level={level} {...{tileSize, edgeSize, boardSize, vMargin, hMargin}} /></div>) : null)}\n                {(nextLevel ? (<div className=\"nextLevel\"><GameBoard level={nextLevel} {...{tileSize, edgeSize, boardSize, vMargin, hMargin}} /></div>) : null)}\n\n            </div>\n        );\n\n    }\n}\n\nGameContainer.propTypes = {\n    level: PropTypes.shape({\n    }),\n};\n\nexport default connect(\n    state => ({\n        level: state.level,\n    }),\n    dispatch => ({\n        resetLevel: id => dispatch(Actions.resetLevel(id)),\n        newGame: id => dispatch(Actions.newGame(id)),\n        visitVertex: id => dispatch(Actions.visitVertex(id))\n    })\n)(GameContainer);","import { connect } from 'react-redux';\nimport * as Actions from './actions';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nclass GameMenu extends Component {\n    render() {\n        let {newGame, resetLevel, showLevelSelect, showRules, progress} = this.props;\n        return (\n            <div className=\"menu\">\n                <button onClick={() => newGame()}>New Game</button>\n                <button onClick={() => resetLevel()}>Retry</button>\n                <button onClick={() => showLevelSelect()}>Level {progress.currentDifficulty}</button>\n                <button onClick={() => showRules()}>Rules</button>\n            </div>\n        );\n    }\n}\n\nGameMenu.propTypes = {\n    level: PropTypes.shape({\n    }),\n    progress: PropTypes.shape({\n    }),\n    resetLevel: PropTypes.func.isRequired,\n    newGame: PropTypes.func.isRequired,\n    showRules: PropTypes.func.isRequired,\n    showLevelSelect: PropTypes.func.isRequired\n};\n\nexport default connect(\n    state => ({\n        progress: state.progress,\n        level: state.level\n    }),\n    dispatch => ({\n        resetLevel: id => dispatch(Actions.resetLevel(id)),\n        newGame: id => dispatch(Actions.newGame(id)),\n        showLevelSelect: id => dispatch(Actions.showLevelSelect(id)),\n        showRules: id => dispatch(Actions.showRules(id)),\n    })\n)(GameMenu);","import { connect } from 'react-redux';\nimport * as Actions from './actions';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\n\nclass TileDescription extends Component {\n    static propTypes = {\n        tileSpec: PropTypes.shape({\n        }),\n        updateTileDescription: PropTypes.func.isRequired\n    }\n    render() {\n        let {tileSpec, updateTileDescription} = this.props;\n        return (\n            <div className=\"rulesrow\">\n                <div className={\"tile symbol symbol-\" + tileSpec.symbol} ></div>\n                <textarea\n                    value={tileSpec.description}\n                    onChange={(e) => {\n                        updateTileDescription(e.target.value);\n                    }}\n                    placeholder=\"Tap to edit when you know the rules\"\n                />\n            </div>\n        );\n    }\n}\n\nclass RulesPage extends Component {\n    render() {\n        let {hideRules, visible, progress, updateTileDescription} = this.props;\n        return (\n            <div className={\"modalpage \" + (visible ? \"visible\" : \"hidden\")}>\n                <div className=\"contentbox\">\n                    <h1>Rules</h1>\n                    <p style={{\n                        maxWidth: 550,\n                        margin: \"auto\",\n                        marginBottom: 50\n                    }}>\n                        Draw a line from the start to the finish, separating the board into regions matching\n                        the tile rules below.\n                    </p>\n\n                    {progress.tileTypes.map((tileSpec, i) => (\n                        <TileDescription\n                            key={i}\n                            tileSpec={tileSpec}\n                            updateTileDescription={(description) => updateTileDescription(i, description)}\n                        />\n                    ))}\n\n                    <button className=\"donebutton\" onClick={() => hideRules()}>Done</button>\n                </div>\n            </div>\n        );\n    }\n}\n\nRulesPage.propTypes = {\n    progress: PropTypes.shape({\n    }),\n    visible: PropTypes.bool.isRequired,\n    hideRules: PropTypes.func.isRequired,\n    updateTileDescription: PropTypes.func.isRequired\n};\n\nexport default connect(\n    state => ({\n        progress: state.progress,\n        visible: state.rulesShown\n    }),\n    dispatch => ({\n        hideRules: id => dispatch(Actions.hideRules(id)),\n        updateTileDescription: (id, description) => dispatch(Actions.updateTileDescription(id, description))\n    })\n)(RulesPage);","import { connect } from 'react-redux';\nimport * as Actions from './actions';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\n\nclass TileDescription extends Component {\n    static propTypes = {\n        progress: PropTypes.shape({\n        }),\n        setCurrentDifficulty: PropTypes.func.isRequired\n    }\n    render() {\n        let {tileSpec, setCurrentDifficulty, difficulty, selected} = this.props;\n        return (\n            <div className={\"rulesrow\" + (selected ? \" selected\" : \"\")} onClick={() => setCurrentDifficulty(difficulty)}>\n                <div className={\"tile symbol symbol-\" + tileSpec.symbol} ></div>\n            Level {difficulty}\n            </div>\n        );\n    }\n}\n\nclass UnlockRow extends Component {\n    static propTypes = {\n        progress: PropTypes.shape({\n        }),\n    }\n    render() {\n        let {progress} = this.props;\n        if (progress.winsToNextUnlock <= 0) return null;\n\n        return (\n            <div className={\"rulesrow\"}>\n                <div className={\"tile symbol symbol-lock\"} ></div>\n                    Win {progress.winsToNextUnlock} more games on level {progress.maxDifficulty} to unlock\n            </div>\n        );\n    }\n}\n\n\nclass LevelSelect extends Component {\n    render() {\n        let {hideLevelSelect, setCurrentDifficulty, visible, progress} = this.props;\n        return (\n            <div className={\"modalpage \" + (visible ? \"visible\" : \"hidden\")}>\n                <div className=\"contentbox\">\n                    <h1>Select a level</h1>\n                    {progress.tileTypes.map((tileSpec, i) => (<TileDescription key={i} selected={progress.currentDifficulty === i + 1} difficulty={i + 1} tileSpec={tileSpec} setCurrentDifficulty={setCurrentDifficulty} />))}\n                    <UnlockRow progress={progress} />\n                </div>\n            </div>\n        );\n    }\n}\n\nLevelSelect.propTypes = {\n    progress: PropTypes.shape({\n    }),\n    visible: PropTypes.bool.isRequired,\n    hideLevelSelect: PropTypes.func.isRequired\n};\n\nexport default connect(\n    state => ({\n        progress: state.progress,\n        visible: state.levelSelectShown\n    }),\n    dispatch => ({\n        setCurrentDifficulty: val => dispatch(Actions.setCurrentDifficulty(val)),\n        hideLevelSelect: id => dispatch(Actions.hideLevelSelect(id))\n    })\n)(LevelSelect);","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport './App.css';\nimport * as Actions from './actions';\nimport GameContainer from './GameContainer';\nimport GameMenu from './GameMenu';\nimport RulesPage from './RulesPage';\nimport LevelSelect from './LevelSelect';\n\nclass App extends Component {\n    componentDidMount() {\n        let {progress, loadProgress} = this.props;\n        if (!progress) {\n            loadProgress();\n        }\n    }\n    render() {\n        let {progress} = this.props;\n\n        if (!progress) return null;\n        return (\n            <div className=\"App\" style={{\n            }}>\n                <h1>Path Game</h1>\n                <GameContainer />\n                <GameMenu />\n                <RulesPage />\n                <LevelSelect />\n            </div>\n        );\n    }\n}\n\nexport default connect(\n    state => ({\n        progress: state.progress,\n    }),\n    dispatch => ({\n        loadProgress: id => dispatch(Actions.loadProgress(id))\n    })\n)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n    if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n        if (publicUrl.origin !== window.location.origin) {\n            // Our service worker won't work if PUBLIC_URL is on a different origin\n            // from what our page is served on. This might happen if a CDN is used to\n            // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n            return;\n        }\n\n        window.addEventListener('load', () => {\n            const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n            if (isLocalhost) {\n                // This is running on localhost. Let's check if a service worker still exists or not.\n                checkValidServiceWorker(swUrl, config);\n\n                // Add some additional logging to localhost, pointing developers to the\n                // service worker/PWA documentation.\n                navigator.serviceWorker.ready.then(() => {\n                    console.log(\n                        'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n                    );\n                });\n            } else {\n                // Is not localhost. Just register service worker\n                registerValidSW(swUrl, config);\n            }\n        });\n    }\n}\n\nfunction registerValidSW(swUrl, config) {\n    navigator.serviceWorker\n        .register(swUrl)\n        .then(registration => {\n            registration.onupdatefound = () => {\n                const installingWorker = registration.installing;\n                if (installingWorker == null) {\n                    return;\n                }\n                installingWorker.onstatechange = () => {\n                    if (installingWorker.state === 'installed') {\n                        if (navigator.serviceWorker.controller) {\n                            // At this point, the updated precached content has been fetched,\n                            // but the previous service worker will still serve the older\n                            // content until all client tabs are closed.\n                            console.log(\n                                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n                            );\n\n                            // Execute callback\n                            if (config && config.onUpdate) {\n                                config.onUpdate(registration);\n                            }\n                        } else {\n                            // At this point, everything has been precached.\n                            // It's the perfect time to display a\n                            // \"Content is cached for offline use.\" message.\n                            console.log('Content is cached for offline use.');\n\n                            // Execute callback\n                            if (config && config.onSuccess) {\n                                config.onSuccess(registration);\n                            }\n                        }\n                    }\n                };\n            };\n        })\n        .catch(error => {\n            console.error('Error during service worker registration:', error);\n        });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n    // Check if the service worker can be found. If it can't reload the page.\n    fetch(swUrl)\n        .then(response => {\n            // Ensure service worker exists, and that we really are getting a JS file.\n            const contentType = response.headers.get('content-type');\n            if (\n                response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n            ) {\n                // No service worker found. Probably a different app. Reload the page.\n                navigator.serviceWorker.ready.then(registration => {\n                    registration.unregister().then(() => {\n                        window.location.reload();\n                    });\n                });\n            } else {\n                // Service worker found. Proceed as normal.\n                registerValidSW(swUrl, config);\n            }\n        })\n        .catch(() => {\n            console.log(\n                'No internet connection found. App is running in offline mode.'\n            );\n        });\n}\n\nexport function unregister() {\n    if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.ready.then(registration => {\n            registration.unregister();\n        });\n    }\n}\n","export const tileTypes = {\n    blank: {\n        validate: () => true\n    },\n    paired: {\n        generateSubtype: (symbol) => {\n            return {\n                tileType: \"paired\",\n                groupSize: Math.floor(Math.random() * 5 + 1),\n                symbol\n            };\n        },\n        place: (tileSpec, regions, tiles) => {\n            console.log(\"placing paired tiles\");\n            // at least two colors, up to the number of regions\n            let availableColors = [\"black\", \"white\", \"orange\", \"blue\", \"green\", \"purple\", \"yellow\"]\n                .map((a) => [Math.random(), a])\n                .sort((a, b) => a[0] - b[0])\n                .map((a) => a[1]);\n            let colorCount = Math.min(availableColors.length, Math.floor(Math.random() * (regions.length - 2) + 2));\n\n            for (let i = 0; i < colorCount; i++) {\n                let color = availableColors[i];\n                let availableRegions = [...regions.keys()].filter(regionId => {\n                    let region = regions[regionId];\n                    // reject regions which already contain a pair\n                    if (region.some(id => {\n                        return tiles[id].tileType === \"paired\" && tiles[id].color === color;\n                    })) return false;\n                    // need at least groupSize free tiles\n                    if (region.filter(id => {\n                        return tiles[id].tileType === \"blank\";\n                    }).length < tileSpec.groupSize) return false;\n                    return true;\n                });\n\n                let regionCount = Math.min(availableRegions.length, Math.floor(Math.random() * (regions.length - 2) + 2));\n\n                for (let j = 0; j < regionCount; j++) {\n                    if (availableRegions.length === 0) continue;\n\n                    let ri = Math.floor(Math.random() * availableRegions.length);\n                    let regionId = availableRegions[ri];\n                    availableRegions.splice(ri, 1);\n                    let region = regions[regionId];\n                    for (let k = 0; k < tileSpec.groupSize; k++) {\n                        let availableTiles = region.filter(id => {\n                            return tiles[id].tileType === \"blank\";\n                        });\n                        let tile = tiles[availableTiles[Math.floor(Math.random() * availableTiles.length)]];\n                        tile.tileType = \"paired\";\n                        tile.color = color;\n                        tile.groupSize = tileSpec.groupSize;\n                        tile.symbol = tileSpec.symbol;\n                    }\n                }\n            }\n        },\n        validate: (tileId, region, tiles, tileState) => {\n            let tile = tiles[tileId];\n            let matchesInRegion = region.filter(id => {\n                let otherTile = tiles[id];\n                if (tile.tileType === otherTile.tileType && tile.color === otherTile.color) {\n                    return true;\n                }\n                return false;\n            });\n            return matchesInRegion.length === tile.groupSize;\n        }\n    },\n    sameColor: {\n        place: (tileSpec, regions, tiles) => {\n            console.log(\"placing sameColor tiles\");\n            // at least two colors, up to the number of regions\n            let availableColors = [\"black\", \"white\", \"orange\", \"blue\", \"green\", \"purple\", \"yellow\"]\n                .map((a) => [Math.random(), a])\n                .sort((a, b) => a[0] - b[0])\n                .map((a) => a[1]);\n            let colorCount = Math.min(availableColors.length, Math.floor(Math.random() * (regions.length - 2) + 2));\n\n            console.log(\"placing sameColor tiles - \" + colorCount);\n\n            let unclaimedRegions = [...regions.keys()];\n            for (let i = 0; i < colorCount; i++) {\n                let ri = Math.floor(Math.random() * unclaimedRegions.length);\n                let regionId = unclaimedRegions[ri];\n                unclaimedRegions.splice(ri, 1);\n                let region = regions[regionId];\n                let maxInRegion = Math.ceil(region.length / 2);\n                let minInRegion = 1;\n                let countInRegion = Math.floor(Math.random() * (maxInRegion - minInRegion) + minInRegion);\n                for (let j = 0; j < countInRegion; j++) {\n                    let tile = tiles[region[Math.floor(Math.random() * region.length)]];\n                    if (tile.tileType !== \"blank\") continue;\n                    tile.tileType = \"sameColor\";\n                    tile.color = availableColors[i];\n                    tile.symbol = tileSpec.symbol;\n                }\n\n            }\n\n        },\n        validate: (tileId, region, tiles, tileState) => {\n            let tile = tiles[tileId];\n            let conflicts = region.filter(id => {\n                if (id === tileId) return false;\n                let otherTile = tiles[id];\n                if (tile.tileType === otherTile.tileType && tile.color !== otherTile.color) {\n                    return true;\n                }\n                return false;\n            });\n            if (conflicts.length > 0) {\n                console.log(\"failed on tile \" + tileId);\n                console.log(tile);\n                console.log(region);\n                console.log(conflicts);\n                console.log(tiles[conflicts[0]]);\n\n            }\n            return conflicts.length === 0;\n        }\n    }\n};\n\nexport const allSymbols = [\"tree\", \"drop\", \"square\", \"circle\", \"diamond\", \"octagon\", \"blob\", \"sun\", \"react\"];\n\n\nfunction neighbouringVertices(vertexId, edges) {\n    return edges.filter((e, i) => {\n        if (e.vertices.length < 2) return false;\n        if (e.vertices[0] === vertexId || e.vertices[1] === vertexId) return true;\n        else return false;\n    }).map((e, i) => {\n        if (e.vertices[0] === vertexId) return e.vertices[1];\n        else return e.vertices[0];\n    });\n}\n\nexport function getVisitedEdges(path, edges) {\n    let visitedEdges = [];\n    for (let i = 0; i < edges.length; i++) {\n        let pi1 = path.indexOf(edges[i].vertices[0]);\n        let pi2 = path.indexOf(edges[i].vertices[1]);\n        if (pi1 >= 0 && pi2 >= 0 && Math.abs(pi2 - pi1) === 1) {\n            visitedEdges.push(i);\n        }\n    }\n    return visitedEdges;\n}\n\n\nfunction expandRegion(startTile, region, unmatchedTiles, tiles, edges, visitedEdges) {\n    unmatchedTiles.splice(unmatchedTiles.indexOf(startTile), 1);\n    region.push(startTile);\n    let neighbours = edges.filter((e, i) => {\n        if (e.tiles.length < 2) return false;\n        if (visitedEdges.indexOf(i) >= 0) return false;\n        let otherTile;\n        if (e.tiles[0] === startTile) otherTile = e.tiles[1];\n        else if (e.tiles[1] === startTile) otherTile = e.tiles[0];\n        else return false;\n        if (unmatchedTiles.indexOf(otherTile) < 0) return false;\n        return true;\n    }).map((e, i) => {\n        if (e.tiles[0] === startTile) return e.tiles[1];\n        else return e.tiles[0];\n    });\n    for (let t of neighbours) {\n    // tile may have matched since the filtering step\n        if (unmatchedTiles.indexOf(t) < 0) continue;\n        expandRegion(t, region, unmatchedTiles, tiles, edges, visitedEdges);\n    }\n}\n\nexport function calculateRegions(tiles, edges, visitedEdges) {\n    let unmatchedTiles = tiles.map((e, i) => i);\n    let regions = [];\n    while (unmatchedTiles.length > 0) {\n        let region = [];\n        expandRegion(unmatchedTiles[0], region, unmatchedTiles, tiles, edges, visitedEdges);\n        regions.push(region);\n    }\n\n    return regions;\n}\n\n\nfunction randomPath(path, vertices, edges, tiles) {\n    if (vertices[path[path.length - 1]].vertexType === \"exit\") {\n    // this may be a valid solution\n        let visitedEdges = getVisitedEdges(path, edges);\n\n        let solution = {\n            path: path,\n            length: path.length,\n            regions: calculateRegions(tiles, edges, visitedEdges),\n            edges: visitedEdges\n\n        };\n        if (solution.regions.length < 4) return null;\n        return solution;\n    }\n\n    // otherwise, see if a random edge leads to a solution\n\n    // all unvisited neighbours\n    let nextPoints = vertices[path[path.length - 1]].neighbours.filter(v => path.indexOf(v) < 0);\n    if (nextPoints.length === 0) {\n    // dead end\n        return null;\n    }\n    let shouldBacktrack = Math.random() > 0.5 && path.length > 1;\n    let foundSolution;\n\n    while (!shouldBacktrack && !foundSolution) {\n        let nextVertexId = nextPoints[Math.floor(Math.random() * nextPoints.length)];\n        let newPath = [...path, nextVertexId];\n        foundSolution = randomPath(newPath, vertices, edges, tiles);\n        if (foundSolution) return foundSolution;\n        shouldBacktrack = Math.random() > 0.5 && path.length > 1;\n    }\n    return null;\n}\n\n\nexport function generateLevel(rows, cols, progress) {\n    console.log(progress);\n    let level = {\n        name: \"Generated Level\",\n        levelId: Math.floor(Math.random() * 10000000),\n        difficulty: progress.currentDifficulty,\n        rows: rows,\n        cols: cols,\n        // 8x8\n        tiles: [],\n        // 8h, 9v\n        edges: [],\n        // 9x9\n        vertices: [],\n        path: [],\n        completed: false,\n        won: false,\n    };\n\n    for (let i = 0; i <= rows; i++) {\n        for (let j = 0; j <= cols; j++) {\n            let vertex = {\n                x: j + 1,\n                y: i + 1,\n                vertexType: \"standard\"\n            };\n            level.vertices.push(vertex);\n        }\n    }\n\n    for (let row = 0; row <= rows; row++) {\n    // add top edge\n        for (let col = 0; col < cols; col++) {\n            let topEdge = {\n                x1: col + 1,\n                y1: row + 1,\n                x2: col + 2,\n                y2: row + 1,\n                broken: false,\n                tiles: [],\n                vertices: [\n                    (row) * (cols + 1) + col,\n                    (row) * (cols + 1) + col + 1]\n            };\n            if (row > 0) {\n                topEdge.tiles.push((row - 1) * cols + col);\n            }\n            if (row < rows) {\n                topEdge.tiles.push((row) * cols + col);\n            }\n            level.edges.push(topEdge);\n        }\n\n        // add left side if not below last row\n        if (row < rows) {\n            for (let col = 0; col <= cols; col++) {\n                let leftEdge = {\n                    x1: col + 1,\n                    y1: row + 1,\n                    x2: col + 1,\n                    y2: row + 2,\n                    broken: false,\n                    tiles: [],\n                    vertices: [\n                        (row) * (cols + 1) + col,\n                        (row + 1) * (cols + 1) + col]\n                };\n                if (col > 0) {\n                    leftEdge.tiles.push((row) * cols + col - 1);\n                }\n                if (col < cols) {\n                    leftEdge.tiles.push((row) * cols + col);\n                }\n                level.edges.push(leftEdge);\n            }\n        }\n    }\n\n    for (let i = 0; i < rows; i++) {\n        for (let j = 0; j < cols; j++) {\n            let tile = {\n                tileType: \"blank\",\n                x1: j + 1,\n                y1: i + 1,\n                x2: j + 2,\n                y2: i + 2\n            };\n            level.tiles.push(tile);\n        }\n    }\n\n\n    for (let i = 0; i < level.vertices.length; i++) {\n        level.vertices[i].neighbours = neighbouringVertices(i, level.edges);\n    }\n\n\n    // add an entry\n    let entries = [Math.floor((rows + 1) * (cols + 1) - cols / 2 - 1)];\n\n    for (let i = 0; i < entries.length; i++) {\n        level.vertices[entries[i]].vertexType = \"entry\";\n    }\n\n\n    // add an exit\n    let exits = [Math.floor(cols / 2)];\n\n    for (let i = 0; i < exits.length; i++) {\n        level.vertices[exits[i]].vertexType = \"exit\";\n    }\n\n\n    // let solutions = [];\n\n\n    //  for (let i = 0; i < entries.length; i++) {\n    //    extendPath([entries[i]], level.vertices, level.edges, solutions)\n    //  }\n\n    let solution = randomPath([entries[0]], level.vertices, level.edges, level.tiles);\n\n    for (let i = 0; i < solution.regions.length; i++) {\n        for (let j = 0; j < solution.regions[i].length; j++) {\n            level.tiles[solution.regions[i][j]].solutionRegion = i;\n        }\n    }\n\n    let minBreaks = 5;\n    let maxBreaks = 20;\n    let breaks = Math.floor(Math.random() * (maxBreaks - minBreaks) + minBreaks);\n    // add random broken edges\n    for (let i = 0; i < breaks; i++) {\n        let edgeId = Math.floor(Math.random() * level.edges.length);\n        if (solution.edges.indexOf(edgeId) >= 0) continue;\n        console.log(\"breaking edge \" + edgeId);\n        level.edges[edgeId].broken = true;\n    }\n\n    // add tiles\n\n    for (let i = 0; i < progress.tileTypes.length && i < level.difficulty; i++) {\n        let tileSpec = progress.tileTypes[i];\n        tileTypes[tileSpec.tileType].place(tileSpec, solution.regions, level.tiles, tileSpec);\n    }\n\n    level.edgeState = level.edges.map(e => ({\n        visited: false\n    }));\n\n    level.vertexState = level.vertices.map(e => ({\n        visited: false\n    }));\n\n    level.tileState = level.tiles.map(e => ({\n        valid: true\n    }));\n\n    level.regions = [level.tiles.map((e, i) => (i))];\n\n    // for testing\n\n    level.vertexState[entries[0]].visited = true;\n    level.path = [entries[0]];\n    level.solution = solution;\n    level.entries = entries;\n    level.exits = exits;\n\n    return level;\n}\n\nexport function generateTileType(progress) {\n    let usedSymbols = progress.tileTypes.map(t => t.symbol);\n    let availableSymbols = allSymbols.filter(s => usedSymbols.indexOf(s) < 0);\n    let symbol = availableSymbols[Math.floor(Math.random() * availableSymbols.length)];\n\n    let availableTypes = Object.keys(tileTypes).filter(t => !!tileTypes[t].generateSubtype);\n\n    let type = tileTypes[availableTypes[Math.floor(Math.random() * availableTypes.length)]];\n    return type.generateSubtype(symbol);\n}\n\n","import { generateLevel, getVisitedEdges, tileTypes, calculateRegions, generateTileType, allSymbols } from './game';\n\n\n\n\nlet initialProgress = {\n    tileTypes: [\n        {\n            tileType: \"paired\",\n            groupSize: 2,\n            symbol: \"diamond\",\n            description: \"Must be matched with one other of the same color\"\n        },\n        {\n            tileType: \"sameColor\",\n            symbol: \"drop\",\n            description: \"Must not share a region with one of a different color\"\n        }\n    ],\n    currentDifficulty: 2,\n    maxDifficulty: 2,\n    winsToNextUnlock: 1\n};\n\nexport const initialState = {\n    // progress: initialProgress,\n    level: {\n        ...generateLevel(6, 6, initialProgress),\n    },\n    levelSelectShown: false,\n    rulesShown: false\n};\n\nfunction persistProgress(progress) {\n    localStorage.setItem(\"progress\", JSON.stringify(progress));\n}\n\nexport const reducer = (state = initialState, action) => {\n    console.log(action.type);\n\n    switch (action.type) {\n    case 'RECEIVE_PROGRESS': {\n        let progress = action.progress || initialProgress;\n        return {\n            ...state,\n            progress,\n            level: {\n                ...generateLevel(6, 6, progress),\n            }\n        };\n    }\n    case 'UPDATE_TILE_DESCRIPTION': {\n        console.log(action);\n        let progress = {\n            ...state.progress,\n            tileTypes: [...state.progress.tileTypes]\n        };\n\n        progress.tileTypes[action.id] = {\n            ...progress.tileTypes[action.id],\n            description: action.description,\n        };\n\n        persistProgress(progress);\n\n        return {\n            ...state,\n            progress\n        };\n    }\n    case 'SHOW_LEVEL_SELECT': {\n        return {\n            ...state,\n            levelSelectShown: true\n        };\n    }\n    case 'HIDE_LEVEL_SELECT': {\n        return {\n            ...state,\n            levelSelectShown: false\n        };\n    }\n    case 'SHOW_RULES': {\n        return {\n            ...state,\n            rulesShown: true\n        };\n    }\n    case 'HIDE_RULES': {\n        return {\n            ...state,\n            rulesShown: false\n        };\n    }\n    case 'SET_CURRENT_DIFFICULTY': {\n        if (action.val === state.progress.currentDifficulty) return {\n            ...state,\n            levelSelectShown: false,\n        };\n        let progress = {\n            ...state.progress,\n            currentDifficulty: action.val,\n        };\n        return {\n            ...state,\n            progress,\n            level: {\n                ...state.level,\n                ...generateLevel(6, 6, progress),\n            },\n            levelSelectShown: false,\n        };\n    }\n    case 'NEW_GAME':\n        return {\n            ...state,\n            level: {\n                ...state.level,\n                ...generateLevel(6, 6, state.progress),\n            }\n        };\n    case 'RESET_LEVEL':\n        return {\n            ...state,\n            level: {\n                ...state.level,\n                edgeState: state.level.edges.map(e => ({\n                    visited: false\n                })),\n\n                vertexState: state.level.vertices.map((e, i) => ({\n                    visited: i === state.level.entries[0]\n                })),\n\n                tileState: state.level.tiles.map(e => ({\n                    valid: true\n                })),\n\n                regions: [state.level.tiles.map((e, i) => (i))],\n\n                path: [state.level.entries[0]],\n\n                completed: false,\n\n                won: false,\n            }\n\n        };\n    case 'VISIT_VERTEX': {\n        console.log(action.type);\n        console.log(action.id);\n        let vertexId = action.id;\n        let vertexState = [...state.level.vertexState];\n        vertexState[vertexId] = {...vertexState[vertexId]};\n        let vertex = state.level.vertices[vertexId];\n        let path = [...state.level.path];\n        let completed = false;\n        let won = false;\n\n        if (!vertex) return state;\n        // no need to keep going once completed\n        if (state.level.completed) return state;\n\n        let lastVertexId = path[path.length - 1];\n        let backtrackVertexId = path[path.length - 2];\n\n        let edgeId = state.level.edges.findIndex(e => {\n            return e.vertices.indexOf(vertexId) >= 0\n          && e.vertices.indexOf(lastVertexId) >= 0\n          && !e.broken;\n        });\n        let edge = state.level.edges[edgeId];\n        console.log(\"Found edge \" + edgeId);\n        console.log(edge);\n\n        // if path is empty, must visit a start point\n        if (path.length === 0 && vertex.vertexType !== \"entry\") {\n            return state;\n        }\n        // if path has only entry point, visiting another entry starts a new path\n        else if (path.length === 1 && vertex.vertexType === \"entry\") {\n            path = [vertexId];\n            vertexState = state.level.vertices.map(e => ({\n                visited: false\n            }));\n            vertexState[vertexId].visited = true;\n        }\n        // restart level by visiting entry point when not on a neighbouring vertex\n        else if (vertex.vertexType === \"entry\" && !edge) {\n            path = [vertexId];\n            vertexState = state.level.vertices.map(e => ({\n                visited: false\n            }));\n            vertexState[vertexId].visited = true;\n        }\n        // backtrack\n        else if (vertexId === backtrackVertexId) {\n            vertexState[path.pop()] = {\n                visited: false\n            };\n        }\n        else if (vertexState[vertexId].visited) {\n        // can't visit twice\n            return state;\n        }\n        else if (path.length > 0 && !edge) {\n        // no valid edge\n            return state;\n        }\n        else {\n        // visiting a new vertex\n            vertexState[vertexId].visited = true;\n            path.push(vertexId);\n            if (vertex.vertexType === \"exit\") {\n                // level completed - check if won\n                completed = true;\n            }\n\n        }\n\n\n\n        let visitedEdges = getVisitedEdges(path, state.level.edges);\n        let edgeState = state.level.edgeState.map((e, i) => {\n            if (visitedEdges.indexOf(i) >= 0) {\n                return {\n                    visited: true\n                };\n            }\n            else {\n                return {\n                    visited: false\n                };\n            }\n        });\n\n        let regions = calculateRegions(state.level.tiles, state.level.edges, visitedEdges);\n        //console.log(\"Current regions: \")\n        //console.log(regions);\n        // now validate the regions against the rules for each file\n        won = true;\n\n        let tileState = state.level.tiles.map((t, i) => {\n            return {\n                ...state.level.tileState[i],\n                valid: true\n            };\n        });\n\n        for (let i = 0; i < regions.length; i++) {\n        // validate each region's tiles. if any is invalid, mutate tileState and set won to false;\n            for (let t of regions[i]) {\n                tileState[t].region = i;\n                let tv = tileTypes[state.level.tiles[t].tileType].validate(t, regions[i], state.level.tiles, tileState);\n                if (!tv) won = false;\n                tileState[t].valid = tv;\n            }\n        }\n\n\n\n        let newState = {\n            ...state,\n            level: {\n                ...state.level,\n                vertexState,\n                edgeState,\n                tileState,\n                path,\n                completed,\n                won,\n                regions\n            }\n        };\n\n        if (won && completed && state.level.difficulty === state.progress.maxDifficulty) {\n            let progress = newState.progress = {...state.progress};\n            progress.winsToNextUnlock--;\n            if (progress.winsToNextUnlock <= 0) {\n                if (progress.tileTypes.length < allSymbols.length - 1) {\n                    progress.winsToNextUnlock = 10;\n                    progress.maxDifficulty++;\n                    progress.currentDifficulty++;\n                    progress.tileTypes = [...progress.tileTypes, generateTileType(progress)];\n                    persistProgress(progress);\n                }\n            }\n        }\n\n        return newState;\n    }\n    default:\n        return state;\n    }\n};\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { Provider } from 'react-redux';\nimport { createStore, applyMiddleware } from 'redux';\nimport { reducer } from './store';\nimport thunk from 'redux-thunk';\n\nconst store = createStore(reducer, applyMiddleware(thunk));\n\nReactDOM.render(\n    <Provider store={store}>\n        <App />\n    </Provider>,\n    document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}