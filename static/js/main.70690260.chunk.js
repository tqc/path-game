(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){e.exports=n(33)},24:function(e,t,n){},26:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(16),l=n.n(o),a=(n(24),n(1)),s=n(2),c=n(5),u=n(3),v=n(4),d=(n(26),n(10)),f=function(e){return{type:"NEW_GAME",text:e}},h=function(e){return{type:"VISIT_VERTEX",id:e}},p=function(e){return{type:"RESET_LEVEL",id:e}},g=n(7),m=function(e){function t(){return Object(a.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tile,n=e.tileState,r=e.tileSize,o=e.edgeSize,l=["tile",t.tileType,n.valid?" valid":" invalid"];return t.symbol&&(l.push("symbol"),l.push("symbol-"+t.symbol)),i.a.createElement("div",{className:l.join(" "),style:{width:r,height:r,left:t.x1*(r+o),top:t.y1*(r+o),color:t.color||"black"}})}}]),t}(r.Component),y=function(e){function t(){return Object(a.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.edge,n=e.edgeState,r=e.tileSize,o=e.edgeSize;return t.x1===t.x2?i.a.createElement("div",{className:"edge vertical"+(n.visited?" visited":"")+(t.broken?" broken":""),style:{width:o,height:r,left:t.x1*(r+o)-o,top:t.y1*(r+o)}}):i.a.createElement("div",{className:"edge horizontal"+(n.visited?" visited":"")+(t.broken?" broken":""),style:{width:r,height:o,left:t.x1*(r+o),top:t.y1*(r+o)-o}})}}]),t}(r.Component),b=function(e){function t(){return Object(a.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.vertex,n=e.vertexState,r=e.tileSize,o=e.edgeSize;return"entry"===t.vertexType?i.a.createElement("div",{className:"vertex "+(t.vertexType||"")+(n.visited?" visited":""),style:{width:3*o,height:3*o,left:t.x*(r+o)-o-o,top:t.y*(r+o)-o-o}}):"exit"===t.vertexType?i.a.createElement("div",{className:"vertex "+(t.vertexType||"")+(n.visited?" visited":""),style:{width:3*o,height:3*o,left:t.x*(r+o)-o-o,top:t.y*(r+o)-o-o}}):i.a.createElement("div",{className:"vertex "+(t.vertexType||"")+(n.visited?" visited":""),style:{width:o,height:o,left:t.x*(r+o)-o,top:t.y*(r+o)-o}})}}]),t}(r.Component),x=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).onMouseDown=e.onMouseDown.bind(Object(g.a)(Object(g.a)(e))),e.onMouseMove=e.onMouseMove.bind(Object(g.a)(Object(g.a)(e))),e.onMouseUp=e.onMouseUp.bind(Object(g.a)(Object(g.a)(e))),e.state={},e.dragging=!1,e}return Object(v.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.div.addEventListener("touchstart",this.onMouseDown),this.div.addEventListener("touchmove",this.onMouseMove,{passive:!1}),this.div.addEventListener("touchend",this.onMouseUp)}},{key:"onMouseDown",value:function(e){this.dragging=!0}},{key:"onMouseMove",value:function(e){if(this.dragging){var t,n,r=this.props,i=r.level,o=r.visitVertex;if(e.targetTouches?(t=e.targetTouches[0],n=e.target,e.preventDefault()):(t=e.nativeEvent,n=e.nativeEvent.target),t&&n){var l=t.clientX-n.offsetLeft,a=t.clientY-n.offsetTop,s=Math.round(l/60)-1,c=Math.round(a/60)-1;if(console.log(l+", "+a+" => "+s+", "+c),s>=0&&c>=0&&c<=i.rows&&s<=i.cols)o(c*(i.cols+1)+s)}}}},{key:"onMouseUp",value:function(e){if(this.dragging){this.dragging=!1;var t,n,r=this.props,i=r.level,o=r.visitVertex;if(e.targetTouches?(t=e.targetTouches[0],n=e.target):(t=e.nativeEvent,n=e.nativeEvent.target),t&&n){var l=t.clientX-n.offsetLeft,a=t.clientY-n.offsetTop,s=Math.round(l/60)-1,c=Math.round(a/60)-1;if(console.log(l+", "+a+" => "+s+", "+c),s>=0&&c>=0&&c<=i.rows&&s<=i.cols)o(c*(i.cols+1)+s)}}}},{key:"render",value:function(){var e=this,t=this.props.level;if(t&&t.tiles&&t.tiles[0]){var n=null;return t.completed&&!t.won?n=i.a.createElement("div",{className:"boardOverlay"}):t.completed&&t.won&&(n=i.a.createElement("div",{className:"boardOverlay"})),i.a.createElement("div",{className:"board "+(t.completed?" completed":"")+(t.won?" won":""),ref:function(t){return e.div=t},onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseUp:this.onMouseUp},t.tiles.map(function(e,n){return i.a.createElement(m,{key:n,tile:e,tileState:t.tileState[n],tileSize:50,edgeSize:10})}),t.edges.map(function(e,n){return i.a.createElement(y,{key:n,edge:e,edgeId:n,edgeState:t.edgeState[n],tileSize:50,edgeSize:10})}),t.vertices.map(function(e,n){return i.a.createElement(b,{key:n,vertex:e,vertexId:n,vertexState:t.vertexState[n],tileSize:50,edgeSize:10})}),n)}return i.a.createElement("div",{className:"board"},"No game loaded;")}}]),t}(r.Component),M=Object(d.b)(function(e){return{}},function(e){return{resetLevel:function(t){return e(p(t))},newGame:function(t){return e(f(t))},visitVertex:function(t){return e(h(t))}}})(x),O=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(v.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.level,r=t.prevLevel,o=t.nextLevel;return i.a.createElement("div",{className:"boardcontainer",ref:function(t){return e.div=t},onClick:this.onClick},r?i.a.createElement("div",{className:"prevLevel"},i.a.createElement(M,{level:r})):null,n?i.a.createElement("div",{className:"currentLevel"},i.a.createElement(M,{level:n})):null,o?i.a.createElement("div",{className:"nextLevel"},i.a.createElement(M,{level:o})):null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.level&&e.level?t.level&&e.level&&t.level.levelId!==e.level.levelId?(console.log("resetting"),{nextLevel:e.level,level:null,prevLevel:t.level}):(!t.level.completed&&e.level.completed&&(e.level.won?setTimeout(function(){return e.newGame()},500):setTimeout(function(){return e.resetLevel()},1e3)),{nextLevel:null,level:e.level,prevLevel:null}):{nextLevel:null,level:e.level,prevLevel:null}}}]),t}(r.Component),j=Object(d.b)(function(e){return{level:e.level}},function(e){return{resetLevel:function(t){return e(p(t))},newGame:function(t){return e(f(t))},visitVertex:function(t){return e(h(t))}}})(O),E=function(e){function t(){return Object(a.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement(j,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var w=n(9),S=n(8),k=n(11),T={blank:{validate:function(){return!0}},paired:{place:function(e,t){console.log("placing paired tiles");for(var n=["black","white","orange","blue","green","purple","yellow"].map(function(e){return[Math.random(),e]}).sort(function(e,t){return e[0]-t[0]}).map(function(e){return e[1]}),r=Math.min(n.length,Math.floor(Math.random()*(e.length-2)+2)),i=function(r){for(var i=n[r],o=Object(k.a)(e.keys()).filter(function(n){var r=e[n];return!r.some(function(e){return"paired"===t[e].tileType&&t[e].color===i})&&!(r.filter(function(e){return"blank"===t[e].tileType}).length<2)}),l=Math.min(o.length,Math.floor(Math.random()*(e.length-2)+2)),a=0;a<l;a++)if(0!==o.length){var s=Math.floor(Math.random()*o.length),c=o[s];o.splice(s,1);for(var u=e[c],v=0;v<2;v++){var d=u.filter(function(e){return"blank"===t[e].tileType}),f=t[d[Math.floor(Math.random()*d.length)]];f.tileType="paired",f.color=i,f.symbol="diamond"}}},o=0;o<r;o++)i(o)},validate:function(e,t,n,r){var i=n[e];return 2===t.filter(function(e){var t=n[e];return i.tileType===t.tileType&&i.color===t.color}).length}},sameColor:{place:function(e,t){console.log("placing sameColor tiles");var n=["black","white","orange","blue","green","purple","yellow"].map(function(e){return[Math.random(),e]}).sort(function(e,t){return e[0]-t[0]}).map(function(e){return e[1]}),r=Math.min(n.length,Math.floor(Math.random()*(e.length-2)+2));console.log("placing sameColor tiles - "+r);for(var i=Object(k.a)(e.keys()),o=0;o<r;o++){var l=Math.floor(Math.random()*i.length),a=i[l];i.splice(l,1);for(var s=e[a],c=Math.ceil(s.length/2),u=Math.floor(Math.random()*(c-1)+1),v=0;v<u;v++){var d=t[s[Math.floor(Math.random()*s.length)]];"blank"===d.tileType&&(d.tileType="sameColor",d.color=n[o],d.symbol="drop")}}},validate:function(e,t,n,r){var i=n[e],o=t.filter(function(t){if(t===e)return!1;var r=n[t];return i.tileType===r.tileType&&i.color!==r.color});return o.length>0&&(console.log("failed on tile "+e),console.log(i),console.log(t),console.log(o),console.log(n[o[0]])),0===o.length}}};function L(e,t){return t.filter(function(t,n){return!(t.vertices.length<2)&&(t.vertices[0]===e||t.vertices[1]===e)}).map(function(t,n){return t.vertices[0]===e?t.vertices[1]:t.vertices[0]})}function N(e,t){for(var n=[],r=0;r<t.length;r++){var i=e.indexOf(t[r].vertices[0]),o=e.indexOf(t[r].vertices[1]);i>=0&&o>=0&&1===Math.abs(o-i)&&n.push(r)}return n}function z(e,t,n,r,i,o){n.splice(n.indexOf(e),1),t.push(e);var l=i.filter(function(t,r){if(t.tiles.length<2)return!1;if(o.indexOf(r)>=0)return!1;var i;if(t.tiles[0]===e)i=t.tiles[1];else{if(t.tiles[1]!==e)return!1;i=t.tiles[0]}return!(n.indexOf(i)<0)}).map(function(t,n){return t.tiles[0]===e?t.tiles[1]:t.tiles[0]}),a=!0,s=!1,c=void 0;try{for(var u,v=l[Symbol.iterator]();!(a=(u=v.next()).done);a=!0){var d=u.value;n.indexOf(d)<0||z(d,t,n,r,i,o)}}catch(f){s=!0,c=f}finally{try{a||null==v.return||v.return()}finally{if(s)throw c}}}function C(e,t,n){for(var r=e.map(function(e,t){return t}),i=[];r.length>0;){var o=[];z(r[0],o,r,e,t,n),i.push(o)}return i}function I(e,t){for(var n={name:"Generated Level",levelId:Math.floor(1e7*Math.random()),rows:e,cols:t,tiles:[],edges:[],vertices:[],path:[],completed:!1,won:!1},r=0;r<=e;r++)for(var i=0;i<=t;i++){var o={x:i+1,y:r+1};n.vertices.push(o)}for(var l=0;l<=e;l++){for(var a=0;a<t;a++){var s={x1:a+1,y1:l+1,x2:a+2,y2:l+1,broken:!1,tiles:[],vertices:[l*(t+1)+a,l*(t+1)+a+1]};l>0&&s.tiles.push((l-1)*t+a),l<e&&s.tiles.push(l*t+a),n.edges.push(s)}if(l<e)for(var c=0;c<=t;c++){var u={x1:c+1,y1:l+1,x2:c+1,y2:l+2,broken:!1,tiles:[],vertices:[l*(t+1)+c,(l+1)*(t+1)+c]};c>0&&u.tiles.push(l*t+c-1),c<t&&u.tiles.push(l*t+c),n.edges.push(u)}}for(var v=0;v<e;v++)for(var d=0;d<t;d++){var f={tileType:"blank",x1:d+1,y1:v+1,x2:d+2,y2:v+2};n.tiles.push(f)}for(var h=0;h<n.vertices.length;h++)n.vertices[h].neighbours=L(h,n.edges);for(var p=[(e+1)*(t+1)-5],g=0;g<p.length;g++)n.vertices[p[g]].vertexType="entry";for(var m=[4],y=0;y<m.length;y++)n.vertices[m[y]].vertexType="exit";for(var b=function e(t,n,r,i){if("exit"===n[t[t.length-1]].vertexType){var o=N(t,r),l={path:t,length:t.length,regions:C(i,r,o),edges:o};return l.regions.length<4?null:l}var a=n[t[t.length-1]].neighbours.filter(function(e){return t.indexOf(e)<0});if(0===a.length)return null;for(var s,c=Math.random()>.5&&t.length>1;!c&&!s;){var u=a[Math.floor(Math.random()*a.length)];if(s=e(Object(k.a)(t).concat([u]),n,r,i))return s;c=Math.random()>.5&&t.length>1}return null}([p[0]],n.vertices,n.edges,n.tiles),x=0;x<b.regions.length;x++)for(var M=0;M<b.regions[x].length;M++)n.tiles[b.regions[x][M]].solutionRegion=x;for(var O=Math.floor(15*Math.random()+5),j=0;j<O;j++){var E=Math.floor(Math.random()*n.edges.length);b.edges.indexOf(E)>=0||(console.log("breaking edge "+E),n.edges[E].broken=!0)}for(var w=["paired","sameColor"],S=0;S<w.length;S++){T[w[S]].place(b.regions,n.tiles)}return n.edgeState=n.edges.map(function(e){return{visited:!1}}),n.vertexState=n.vertices.map(function(e){return{visited:!1}}),n.tileState=n.tiles.map(function(e){return{valid:!0}}),n.regions=[n.tiles.map(function(e,t){return t})],n.vertexState[p[0]].visited=!0,n.path=[p[0]],n.solution=b,n.entries=p,n.exits=m,n}var V={level:Object(S.a)({},I(8,8))},D=Object(w.b)({level:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.level,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t.type),t.type){case"NEW_GAME":return Object(S.a)({},e,I(8,8));case"RESET_LEVEL":return Object(S.a)({},e,{edgeState:e.edges.map(function(e){return{visited:!1}}),vertexState:e.vertices.map(function(t,n){return{visited:n===e.entries[0]}}),tileState:e.tiles.map(function(e){return{valid:!0}}),regions:[e.tiles.map(function(e,t){return t})],path:[e.entries[0]],completed:!1,won:!1});case"VISIT_VERTEX":console.log(t.type),console.log(t.id);var n=t.id,r=Object(k.a)(e.vertexState);r[n]=Object(S.a)({},r[n]);var i=e.vertices[n],o=Object(k.a)(e.path),l=!1,a=!1;if(!i)return e;if(e.completed)return e;var s=o[o.length-1],c=o[o.length-2],u=e.edges.findIndex(function(e){return e.vertices.indexOf(n)>=0&&e.vertices.indexOf(s)>=0&&!e.broken}),v=e.edges[u];if(console.log("Found edge "+u),console.log(v),0===o.length&&"entry"!==i.vertexType)return e;if(1===o.length&&"entry"===i.vertexType)o=[n],(r=e.vertices.map(function(e){return{visited:!1}}))[n].visited=!0;else if("entry"!==i.vertexType||v)if(n===c)r[o.pop()]={visited:!1};else{if(r[n].visited)return e;if(o.length>0&&!v)return e;r[n].visited=!0,o.push(n),"exit"===i.vertexType&&(l=!0)}else o=[n],(r=e.vertices.map(function(e){return{visited:!1}}))[n].visited=!0;var d=N(o,e.edges),f=e.edgeState.map(function(e,t){return d.indexOf(t)>=0?{visited:!0}:{visited:!1}}),h=C(e.tiles,e.edges,d);a=!0;for(var p=e.tiles.map(function(t,n){return Object(S.a)({},e.tileState[n],{valid:!0})}),g=0;g<h.length;g++){var m=!0,y=!1,b=void 0;try{for(var x,M=h[g][Symbol.iterator]();!(m=(x=M.next()).done);m=!0){var O=x.value;p[O].region=g;var j=T[e.tiles[O].tileType].validate(O,h[g],e.tiles,p);j||(a=!1),p[O].valid=j}}catch(E){y=!0,b=E}finally{try{m||null==M.return||M.return()}finally{if(y)throw b}}}return Object(S.a)({},e,{vertexState:r,edgeState:f,tileState:p,path:o,completed:l,won:a,regions:h});default:return e}}}),G=Object(w.c)(D);l.a.render(i.a.createElement(d.a,{store:G},i.a.createElement(E,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,2,1]]]);
//# sourceMappingURL=main.70690260.chunk.js.map