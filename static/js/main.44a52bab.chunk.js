(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){e.exports=n(34)},24:function(e,t,n){},26:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},27:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),l=n(16),a=n.n(l),o=(n(24),n(1)),c=n(2),s=n(4),v=n(3),u=n(5),d=(n(26),n(27),n(8)),f=n(7),h=n(10),p=n(9),m=0,g=function(e){return{type:"NEW_GAME",id:m++,text:e}},b=function(e){return{type:"VISIT_VERTEX",id:e}},y=function(e){return{type:"RESET_LEVEL",id:e}},x={blank:{validate:function(){return!0}},sameColor:{place:function(e,t){console.log("placing sameColor tiles");var n=["black","white","red","blue","green"],r=Math.min(n.length,Math.floor(Math.random()*(e.length-2)+2));console.log("placing sameColor tiles - "+r);for(var i=Object(h.a)(e.keys()),l=0;l<r;l++){var a=Math.floor(Math.random()*i.length),o=i[a];i.splice(a,1);for(var c=e[o],s=Math.ceil(c.length/2),v=Math.floor(Math.random()*(s-1)+1),u=0;u<v;u++){var d=t[c[Math.floor(Math.random()*c.length)]];"blank"==d.tileType&&(d.tileType="sameColor",d.color=n[l])}}},validate:function(e,t,n,r){var i=n[e],l=t.filter(function(t){if(t==e)return!1;var r=n[t];return i.tileType==r.tileType&&i.color!=r.color||void 0});return l.length>0&&(console.log("failed on tile "+e),console.log(i),console.log(t),console.log(l),console.log(n[l[0]])),0==l.length}}};function O(e,t){return t.filter(function(t,n){return!(t.vertices.length<2)&&(t.vertices[0]===e||t.vertices[1]===e)}).map(function(t,n){return t.vertices[0]===e?t.vertices[1]:t.vertices[0]})}function j(e,t){for(var n=[],r=0;r<t.length;r++){var i=e.indexOf(t[r].vertices[0]),l=e.indexOf(t[r].vertices[1]);i>=0&&l>=0&&1==Math.abs(l-i)&&n.push(r)}return n}function E(e,t){for(var n={name:"Generated Level",levelId:Math.floor(1e7*Math.random()),rows:e,cols:t,tiles:[],edges:[],vertices:[],path:[],completed:!1,won:!1},r=0;r<=e;r++)for(var i=0;i<=t;i++){var l={x:i+1,y:r+1};n.vertices.push(l)}for(var a=0;a<=e;a++){for(var o=0;o<t;o++){var c={x1:o+1,y1:a+1,x2:o+2,y2:a+1,broken:!1,tiles:[],vertices:[a*(t+1)+o,a*(t+1)+o+1]};a>0&&c.tiles.push((a-1)*t+o),a<e&&c.tiles.push(a*t+o),n.edges.push(c)}if(a<e)for(var s=0;s<=t;s++){var v={x1:s+1,y1:a+1,x2:s+1,y2:a+2,broken:!1,tiles:[],vertices:[a*(t+1)+s,(a+1)*(t+1)+s]};s>0&&v.tiles.push(a*t+s-1),s<t&&v.tiles.push(a*t+s),n.edges.push(v)}}for(var u=0;u<e;u++)for(var d=0;d<t;d++){var f={tileType:"blank",x1:d+1,y1:u+1,x2:d+2,y2:u+2};n.tiles.push(f)}for(var p=0;p<n.vertices.length;p++)n.vertices[p].neighbours=O(p,n.edges);for(var m=[(e+1)*(t+1)-5],g=0;g<m.length;g++)n.vertices[m[g]].vertexType="entry";for(var b=[4],y=0;y<b.length;y++)n.vertices[b[y]].vertexType="exit";for(var E=function e(t,n,r,i){if("exit"==n[t[t.length-1]].vertexType){var l=j(t,r),a={path:t,length:t.length,regions:w(i,r,l)};return a.regions.length<4?null:a}var o=n[t[t.length-1]].neighbours.filter(function(e){return t.indexOf(e)<0});if(0==o.length)return null;for(var c,s=Math.random()>.5&&t.length>1;!s&&!c;){var v=o[Math.floor(Math.random()*o.length)];if(c=e(Object(h.a)(t).concat([v]),n,r,i))return c;s=Math.random()>.5&&t.length>1}return null}([m[0]],n.vertices,n.edges,n.tiles),S=0;S<E.regions.length;S++)for(var k=0;k<E.regions[S].length;k++)n.tiles[E.regions[S][k]].solutionRegion=S;for(var T=Math.floor(15*Math.random()+5),M=0;M<T;M++){var L=Math.floor(Math.random()*n.edges.length);E.path.indexOf(L)>=0||(console.log("breaking edge "+L),n.edges[L].broken=!0)}for(var C=["sameColor"],N=0;N<C.length;N++){x[C[N]].place(E.regions,n.tiles)}return n.edgeState=n.edges.map(function(e){return{visited:!1}}),n.vertexState=n.vertices.map(function(e){return{visited:!1}}),n.tileState=n.tiles.map(function(e){return{valid:!0}}),n.regions=[n.tiles.map(function(e,t){return t})],n.vertexState[m[0]].visited=!0,n.path=[m[0]],n}function S(e,t,n,r,i,l){n.splice(n.indexOf(e),1),t.push(e);var a=i.filter(function(t,r){if(t.tiles.length<2)return!1;if(l.indexOf(r)>=0)return!1;var i;if(t.tiles[0]===e)i=t.tiles[1];else{if(t.tiles[1]!==e)return!1;i=t.tiles[0]}return!(n.indexOf(i)<0)}).map(function(t,n){return t.tiles[0]===e?t.tiles[1]:t.tiles[0]}),o=!0,c=!1,s=void 0;try{for(var v,u=a[Symbol.iterator]();!(o=(v=u.next()).done);o=!0){var d=v.value;n.indexOf(d)<0||S(d,t,n,r,i,l)}}catch(f){c=!0,s=f}finally{try{o||null==u.return||u.return()}finally{if(c)throw s}}}function w(e,t,n){for(var r=e.map(function(e,t){return t}),i=[];r.length>0;){var l=[];S(r[0],l,r,e,t,n),i.push(l)}return i}var k={level:Object(f.a)({},E(8,8))},T=Object(p.b)({level:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k.level,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t.type),t.type){case"NEW_GAME":return Object(f.a)({},e,E(8,8));case"RESET_LEVEL":return Object(f.a)({},e,{edgeState:e.edges.map(function(e){return{visited:!1}}),vertexState:e.vertices.map(function(e){return{visited:!1}}),tileState:e.tiles.map(function(e){return{valid:!0}}),regions:[e.tiles.map(function(e,t){return t})],path:[],completed:!1,won:!1});case"VISIT_VERTEX":console.log(t.type),console.log(t.id);var n=t.id,r=Object(h.a)(e.vertexState);r[n]=Object(f.a)({},r[n]);var i=e.vertices[n],l=Object(h.a)(e.path),a=!1,o=!1;if(!i)return e;if(e.completed)return e;var c=l[l.length-1],s=l[l.length-2],v=e.edges.findIndex(function(e){return e.vertices.indexOf(n)>=0&&e.vertices.indexOf(c)>=0&&!e.broken}),u=e.edges[v];if(console.log("Found edge "+v),console.log(u),0===l.length&&"entry"!=i.vertexType)return e;if(1==l.length&&"entry"==i.vertexType)return e;if(n==c||n==s)r[l.pop()]={visited:!1};else{if(r[n].visited)return e;if(l.length>0&&!u)return e;r[n].visited=!0,l.push(n),"exit"==i.vertexType&&(a=!0)}var d=j(l,e.edges),p=e.edgeState.map(function(e,t){return d.indexOf(t)>=0?{visited:!0}:{visited:!1}}),m=w(e.tiles,e.edges,d);o=!0;for(var g=e.tiles.map(function(t,n){return Object(f.a)({},e.tileState[n],{valid:!0})}),b=0;b<m.length;b++){var y=!0,O=!1,S=void 0;try{for(var T,M=m[b][Symbol.iterator]();!(y=(T=M.next()).done);y=!0){var L=T.value;g[L].region=b;var C=x[e.tiles[L].tileType].validate(L,m[b],e.tiles,g);C||(o=!1),g[L].valid=C}}catch(N){O=!0,S=N}finally{try{y||null==M.return||M.return()}finally{if(O)throw S}}}return Object(f.a)({},e,{vertexState:r,edgeState:p,tileState:g,path:l,completed:a,won:o,regions:m});case"ADD_TODO":return Object(f.a)({},e,{id:t.id,text:t.text,completed:!1});case"TOGGLE_TODO":return e.map(function(e){return e.id===t.id?Object(f.a)({},e,{completed:!e.completed}):e});default:return e}}}),M=n(11),L=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tile,n=e.tileState,r=e.tileSize,l=e.edgeSize;return i.a.createElement("div",{className:"tile "+(t.tileType||"")+(n.valid?" valid":" invalid"),style:{width:r,height:r,left:t.x1*(r+l),top:t.y1*(r+l),color:t.color||"black"}})}}]),t}(r.Component),C=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.edge,n=(e.edgeId,e.edgeState),r=e.tileSize,l=e.edgeSize;return t.x1==t.x2?i.a.createElement("div",{className:"edge vertical"+(n.visited?" visited":"")+(t.broken?" broken":""),style:{width:l,height:r,left:t.x1*(r+l)-l,top:t.y1*(r+l)}}):i.a.createElement("div",{className:"edge horizontal"+(n.visited?" visited":"")+(t.broken?" broken":""),style:{width:r,height:l,left:t.x1*(r+l),top:t.y1*(r+l)-l}})}}]),t}(r.Component),N=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.vertex,n=(e.vertexId,e.vertexState),r=e.tileSize,l=e.edgeSize;return"entry"==t.vertexType?i.a.createElement("div",{className:"vertex "+(t.vertexType||"")+(n.visited?" visited":""),style:{width:3*l,height:3*l,left:t.x*(r+l)-l-l,top:t.y*(r+l)-l-l}}):"exit"==t.vertexType?i.a.createElement("div",{className:"vertex "+(t.vertexType||"")+(n.visited?" visited":""),style:{width:3*l,height:3*l,left:t.x*(r+l)-l-l,top:t.y*(r+l)-l-l}}):i.a.createElement("div",{className:"vertex "+(t.vertexType||"")+(n.visited?" visited":""),style:{width:l,height:l,left:t.x*(r+l)-l,top:t.y*(r+l)-l}})}}]),t}(r.Component),z=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(s.a)(this,Object(v.a)(t).call(this))).onClick=e.onClick.bind(Object(M.a)(Object(M.a)(e))),e.state={},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onClick",value:function(e){var t=this.props,n=t.level,r=t.visitVertex,i=e.nativeEvent.clientX-this.div.offsetLeft,l=e.nativeEvent.clientY-this.div.offsetTop,a=Math.round(i/60)-1,o=Math.round(l/60)-1;(console.log(i+", "+l+" => "+a+", "+o),a>=0&&o>=0&&o<=n.rows&&a<=n.cols)&&r(o*(n.cols+1)+a)}},{key:"render",value:function(){var e=this,t=this.props.level;if(t&&t.tiles&&t.tiles[0]){var n=null;return t.completed&&!t.won?n=i.a.createElement("div",{className:"boardOverlay"},"Failed"):t.completed&&t.won&&(n=i.a.createElement("div",{className:"boardOverlay"},"You win")),i.a.createElement("div",{className:"board "+(t.completed?" completed":"")+(t.won?" won":""),ref:function(t){return e.div=t},onClick:this.onClick},t.tiles.map(function(e,n){return i.a.createElement(L,{tile:e,tileState:t.tileState[n],tileSize:50,edgeSize:10})}),t.edges.map(function(e,n){return i.a.createElement(C,{edge:e,edgeId:n,edgeState:t.edgeState[n],tileSize:50,edgeSize:10})}),t.vertices.map(function(e,n){return i.a.createElement(N,{vertex:e,vertexId:n,vertexState:t.vertexState[n],tileSize:50,edgeSize:10})}),n)}return i.a.createElement("div",{className:"board"},"No game loaded;")}}]),t}(r.Component),I=Object(d.b)(function(e){return{}},function(e){return{resetLevel:function(t){return e(y(t))},newGame:function(t){return e(g(t))},visitVertex:function(t){return e(b(t))}}})(z),G=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(s.a)(this,Object(v.a)(t).call(this))).state={},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.level,r=t.prevLevel,l=t.nextLevel;return i.a.createElement("div",{className:"boardcontainer",ref:function(t){return e.div=t},onClick:this.onClick},r?i.a.createElement("div",{className:"prevLevel"},i.a.createElement(I,{level:r})):null,n?i.a.createElement("div",{className:"currentLevel"},i.a.createElement(I,{level:n})):null,l?i.a.createElement("div",{className:"nextLevel"},i.a.createElement(I,{level:l})):null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.level&&e.level?t.level&&e.level&&t.level.levelId!=e.level.levelId?(console.log("resetting"),{nextLevel:e.level,level:null,prevLevel:t.level}):(!t.level.completed&&e.level.completed&&(e.level.won?setTimeout(function(){return e.newGame()},500):setTimeout(function(){return e.resetLevel()},1e3)),{nextLevel:null,level:e.level,prevLevel:null}):{nextLevel:null,level:e.level,prevLevel:null}}}]),t}(r.Component),V=Object(d.b)(function(e){return{level:e.level}},function(e){return{resetLevel:function(t){return e(y(t))},newGame:function(t){return e(g(t))},visitVertex:function(t){return e(b(t))}}})(G),_=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.newGame,n=e.resetLevel;return i.a.createElement("div",{className:"menu"},i.a.createElement("button",{onClick:function(){return t()}},"New Game"),i.a.createElement("button",{onClick:function(){return n()}},"Retry"))}}]),t}(r.Component),R=Object(d.b)(function(e){return{level:e.level}},function(e){return{resetLevel:function(t){return e(y(t))},newGame:function(t){return e(g(t))}}})(_),D=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement(V,null),i.a.createElement(R,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=Object(p.c)(T);a.a.render(i.a.createElement(d.a,{store:A},i.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,2,1]]]);
//# sourceMappingURL=main.44a52bab.chunk.js.map